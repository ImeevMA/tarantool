-- test-run result file version 2
build_path = os.getenv("BUILDDIR")
 | ---
 | ...
package.cpath = build_path..'/test/box/?.so;'..build_path..'/test/box/?.dylib;'..package.cpath
 | ---
 | ...

box.cfg{}
 | ---
 | ...
box.execute([[CREATE TABLE T(I INT PRIMARY KEY, A INT);]])
 | ---
 | - row_count: 1
 | ...
box.execute([[INSERT INTO T VALUES(1,1), (2,22), (3,333);]])
 | ---
 | - row_count: 3
 | ...
box.execute([[INSERT INTO T VALUES(4,1), (5,22), (6,333);]])
 | ---
 | - row_count: 3
 | ...

one = box.lib.load('one')
 | ---
 | ...
get_stmt = one:load("get_stmt")
 | ---
 | ...
s = get_stmt("SELECT * FROM SEQSCAN T;")
 | ---
 | ...
exec_rv_stmt = one:load("exec_rv_stmt")
 | ---
 | ...
exec_rv_stmt(s, 0)
 | ---
 | - [['I', 'A'], ['integer', 'integer'], [[1, 1], [2, 22], [3, 333], [4, 1], [5, 22],
 |     [6, 333]]]
 | ...

get_rv = one:load("get_rv")
 | ---
 | ...
r = get_rv("rv_one")
 | ---
 | ...
exec_rv_stmt(s, r)
 | ---
 | - [['I', 'A'], ['integer', 'integer'], [[1, 1], [2, 22], [3, 333], [4, 1], [5, 22],
 |     [6, 333]]]
 | ...

box.space.T:delete({5})
 | ---
 | - [5, 22]
 | ...
exec_rv_stmt(s, r)
 | ---
 | - [['I', 'A'], ['integer', 'integer'], [[1, 1], [2, 22], [3, 333], [4, 1], [5, 22],
 |     [6, 333]]]
 | ...
exec_rv_stmt(s, 0)
 | ---
 | - [['I', 'A'], ['integer', 'integer'], [[1, 1], [2, 22], [3, 333], [4, 1], [6, 333]]]
 | ...

box.space.T:truncate()
 | ---
 | ...
exec_rv_stmt(s, r)
 | ---
 | - [['I', 'A'], ['integer', 'integer'], [[1, 1], [2, 22], [3, 333], [4, 1], [5, 22],
 |     [6, 333]]]
 | ...
exec_rv_stmt(s, 0)
 | ---
 | - [['I', 'A'], ['integer', 'integer'], []]
 | ...
